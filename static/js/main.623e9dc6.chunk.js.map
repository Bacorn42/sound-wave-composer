{"version":3,"sources":["components/roll/NoteSettings.js","constants.js","tones.js","Note.js","components/roll/Display.js","waves/sine/tones.js","wav/WAVWriter.js","components/roll/Generator.js","components/roll/Roll.js","App.js","index.js"],"names":["NoteSettings","note","draw","deleteNote","useState","tuningOffset","setTuningOffset","getLength","length","setLength","useEffect","className","value","onChange","e","target","onClick","SAMPLES","SIZE","VOLUME","PX_TO_TONE","A4","toneArray","reverse","toneNames","Note","x","y","this","width","height","offset","getX","getY","WIDTH_UNITS","Display","notes","canvas","useRef","selectedNote","setSelectedNote","ctx","current","getContext","clearRect","font","lineWidth","strokeStyle","i","beginPath","moveTo","lineTo","stroke","TONES","fillStyle","fillRect","strokeRect","fillText","getMouseCoords","rect","getBoundingClientRect","clientX","left","clientY","top","ref","coords","inRect","snapX","Math","floor","snapY","push","splice","index","findIndex","getTone","freq","arr","val","sin","PI","numberToBytes","num","numberOfBytes","bytes","Array","fill","byte","stringToBytes","str","split","map","c","charCodeAt","pushBigEndian","content","pushLittleEndian","getWAV","waveData","pushHeaders","pushWaveData","byteArray","Uint8Array","blob","Blob","type","window","URL","createObjectURL","Generator","setWaveData","normalize","max","reduce","setTimeout","getOffset","wave","console","log","normalizedArr","src","controls","Roll","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.623e9dc6.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './NoteSettings.css';\r\n\r\nfunction NoteSettings({ note, draw, deleteNote }) {\r\n  const [tuningOffset, setTuningOffset] = useState(note.tuningOffset);\r\n  const [length, setLength] = useState(note.getLength());\r\n\r\n  useEffect(() => {\r\n    setTuningOffset(note.tuningOffset);\r\n    setLength(note.getLength());\r\n  }, [note])\r\n\r\n  const handleTuningOffset = (e) => {\r\n    const value = e.target.value;\r\n    setTuningOffset(value);\r\n    note.setTuningOffset(value);\r\n    draw();\r\n  }\r\n\r\n  const handleLength = (e) => {\r\n    const value = e.target.value;\r\n    setLength(value);\r\n    note.setLength(value);\r\n    draw();\r\n  }\r\n\r\n  return (\r\n    <div className=\"note-settings\">\r\n      Tuning offset <input value={tuningOffset} onChange={handleTuningOffset}></input> cents.<br />\r\n      Length <input value={length} onChange={handleLength}></input>s.<br />\r\n      <button onClick={deleteNote}>Delete</button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default NoteSettings;\r\n","export const LENGTH = 20/ 4;\r\nexport const SAMPLES = 44100;\r\nexport const SIZE = SAMPLES * 4 * LENGTH;\r\nexport const VOLUME = 25 * (32767/100);\r\n\r\nexport const PX_TO_S = 20 * 4;\r\nexport const PX_TO_TONE = 20;","export const A4 = 440;\r\nexport const AS4 = A4 * (2**(1/12));\r\nexport const B4 = A4 * (2**(2/12));\r\nexport const C5 = A4 * (2**(3/12));\r\nexport const CS5 = A4 * (2**(4/12));\r\nexport const D5 = A4 * (2**(5/12));\r\nexport const DS5 = A4 * (2**(6/12));\r\nexport const E5 = A4 * (2**(7/12));\r\nexport const F5 = A4 * (2**(8/12));\r\nexport const FS5 = A4 * (2**(9/12));\r\nexport const G5 = A4 * (2**(10/12));\r\nexport const GS5 = A4 * (2**(11/12));\r\n\r\nexport const toneArray = [A4, AS4, B4, C5, CS5, D5, DS5, E5, F5, FS5, G5, GS5].reverse();\r\nexport const toneNames = ['A4', 'A♯4', 'B4', 'C5', 'C♯5', 'D5', 'D♯5', 'E5', 'F5', 'F♯5', 'G5', 'G♯5'].reverse();","import { PX_TO_S, PX_TO_TONE } from './constants.js';\r\nimport { toneArray } from './tones.js';\r\n\r\nclass Note {\r\n  constructor(x, y) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = PX_TO_S;\r\n    this.height = PX_TO_TONE;\r\n    this.tuningOffset = 0;\r\n    this.length = 1;\r\n  }\r\n\r\n  getX() {\r\n    return this.x;\r\n  }\r\n\r\n  getY() {\r\n    return this.y - (this.tuningOffset/100 * PX_TO_TONE);\r\n  }\r\n\r\n  getOffset() {\r\n    return this.x / PX_TO_S;\r\n  }\r\n\r\n  getTone() {\r\n    return toneArray[this.y / PX_TO_TONE] * (2**(this.tuningOffset/1200));\r\n  }\r\n\r\n  getLength() {\r\n    return this.length;\r\n  }\r\n\r\n  setLength(length) {\r\n    this.length = length;\r\n    this.width = PX_TO_S * length;\r\n  }\r\n\r\n  setTuningOffset(offset) {\r\n    this.tuningOffset = offset;\r\n  }\r\n\r\n  inRect(x, y) {\r\n    return (x >= this.getX()) && (x <= this.getX() + this.width) && (y >= this.getY()) && (y <= this.getY() + this.height);\r\n  }\r\n}\r\n\r\nexport default Note;","import React, { useRef, useEffect, useState } from 'react';\r\nimport './Display.css';\r\nimport NoteSettings from './NoteSettings.js';\r\nimport Note from '../../Note.js';\r\nimport { toneNames } from '../../tones.js';\r\nimport { PX_TO_TONE } from '../../constants.js';\r\n\r\nconst TONES = 12;\r\nconst WIDTH_UNITS = 20;\r\nconst HEIGHT = TONES * PX_TO_TONE;\r\nconst WIDTH = WIDTH_UNITS * 20;\r\n\r\nfunction Display({ notes }) {\r\n  const canvas = useRef(null);\r\n  const [selectedNote, setSelectedNote] = useState(null);\r\n\r\n  const draw = () => {\r\n    const ctx = canvas.current.getContext('2d');\r\n    ctx.clearRect(0, 0, canvas.current.width, canvas.current.height);\r\n    ctx.font = '16px sans-serif';\r\n    ctx.lineWidth = 1;\r\n    ctx.strokeStyle = '#666';\r\n    for(let i = 1; i < TONES; i++) {\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, PX_TO_TONE * i + 0.5);\r\n      ctx.lineTo(WIDTH, PX_TO_TONE * i +0.5);\r\n      ctx.stroke();\r\n    }\r\n    for(let i = 1; i < WIDTH_UNITS; i++) {\r\n      ctx.beginPath();\r\n      ctx.moveTo(WIDTH_UNITS * i + 0.5, 0);\r\n      ctx.lineTo(WIDTH_UNITS * i + 0.5, HEIGHT);\r\n      ctx.stroke();\r\n    }\r\n    ctx.fillStyle = '#ccc';\r\n    for(const note of notes) {\r\n      ctx.fillRect(note.getX() + 2, note.getY() + 2, note.width - 3, note.height - 3);\r\n      ctx.strokeStyle = (note === selectedNote) ? '#900' : '#666';\r\n      ctx.lineWidth = 2;\r\n      ctx.strokeRect(note.getX() + 2.5, note.getY() + 2.5, note.width - 4, note.height - 4);\r\n    }\r\n    ctx.fillStyle = '#000';\r\n    for(let i = 0; i < TONES; i++) {\r\n      ctx.fillText(toneNames[i], 0, PX_TO_TONE * (i + 1) - 4);\r\n    }\r\n  }\r\n\r\n  const clickHandler = (e) => {\r\n    const coords = getMouseCoords(e);\r\n    for(const note of notes) {\r\n      if(note.inRect(coords.x, coords.y)) {\r\n        setSelectedNote(note);\r\n        draw();\r\n        return;\r\n      }\r\n    }\r\n    const snapX = Math.floor((coords.x)/WIDTH_UNITS) * WIDTH_UNITS;\r\n    const snapY = Math.floor((coords.y)/WIDTH_UNITS) * WIDTH_UNITS;\r\n    notes.push(new Note(snapX, snapY));\r\n    setSelectedNote(null);\r\n    draw();\r\n  }\r\n\r\n  const getMouseCoords = (e) => {\r\n    const rect = e.target.getBoundingClientRect();\r\n    const mouseX = e.clientX - rect.left;\r\n    const mouseY = e.clientY - rect.top;\r\n    return {\r\n      x: mouseX,\r\n      y: mouseY,\r\n    };\r\n  }\r\n\r\n  const clear = () => {\r\n    notes.splice(0, notes.length);\r\n    setSelectedNote(null);\r\n    draw();\r\n  }\r\n\r\n  const deleteNote = () => {\r\n    const index = notes.findIndex(note => note === selectedNote);\r\n    notes.splice(index, 1);\r\n    setSelectedNote(null);\r\n  }\r\n\r\n  useEffect(() => draw());\r\n\r\n  return (\r\n    <div className=\"display\">\r\n      <div className=\"display-canvas\">\r\n        <canvas ref={canvas} width={WIDTH} height={HEIGHT} onClick={clickHandler}></canvas>\r\n        <button onClick={clear}>Clear</button>\r\n      </div>\r\n      {selectedNote && <NoteSettings note={selectedNote} draw={draw} deleteNote={deleteNote}></NoteSettings>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Display;\r\n","import { SAMPLES, VOLUME } from '../../constants.js';\r\n\r\nexport function getTone(freq, length) {\r\n  const arr = []\r\n  for(let i = 0; i < SAMPLES * length; i++) {\r\n      const val = Math.floor(Math.sin(freq * 2 * Math.PI * (i/SAMPLES)) * VOLUME);\r\n      arr.push(val);\r\n      arr.push(val);\r\n  }\r\n  return arr;\r\n}","import { SAMPLES, SIZE } from '../constants.js';\r\n\r\nfunction numberToBytes(num, numberOfBytes) {\r\n  const bytes = new Array(numberOfBytes).fill(0);\r\n  for(let i = 0; i < numberOfBytes; i++) {\r\n      const byte = (num >> (8*i)) & 0xFF;\r\n      bytes[i] = byte;\r\n  }\r\n  bytes.reverse();\r\n  return bytes;\r\n}\r\n\r\nfunction stringToBytes(str) {\r\n  return str.split('').map(c => c.charCodeAt(0));\r\n}\r\n\r\nfunction pushBigEndian(arr, content) {\r\n  for(const val of content) {\r\n      arr.push(val);\r\n  }\r\n}\r\n\r\nfunction pushLittleEndian(arr, content) {\r\n  for(let i = content.length - 1; i >= 0; i--) {\r\n      arr.push(content[i]);\r\n  }\r\n}\r\n\r\nfunction pushWaveData(arr, waveData) {\r\n  for(const val of waveData) {\r\n      pushLittleEndian(arr, numberToBytes(val, 2));\r\n  }\r\n}\r\n\r\nfunction pushHeaders(arr) {\r\n  pushBigEndian(arr, stringToBytes(\"RIFF\"));\r\n  pushLittleEndian(arr, numberToBytes(36 + SIZE, 4));\r\n  pushBigEndian(arr, stringToBytes(\"WAVE\"));\r\n  pushBigEndian(arr, stringToBytes(\"fmt \"));\r\n  pushLittleEndian(arr, numberToBytes(16, 4));\r\n  pushLittleEndian(arr, numberToBytes(1, 2));\r\n  pushLittleEndian(arr, numberToBytes(2, 2));\r\n  pushLittleEndian(arr, numberToBytes(SAMPLES, 4));\r\n  pushLittleEndian(arr, numberToBytes(SAMPLES * 4, 4));\r\n  pushLittleEndian(arr, numberToBytes(4, 2));\r\n  pushLittleEndian(arr, numberToBytes(16, 2));\r\n  pushBigEndian(arr, stringToBytes(\"data\"));\r\n  pushLittleEndian(arr, numberToBytes(SIZE, 4));\r\n}\r\n\r\nfunction getWAV(waveData) {\r\n  const arr = [];\r\n\r\n  pushHeaders(arr);\r\n  pushWaveData(arr, waveData);\r\n    \r\n  const byteArray = new Uint8Array(arr);\r\n  const blob = new Blob([byteArray], { type: 'application/octet-stream' });\r\n\r\n  return window.URL.createObjectURL(blob);\r\n}\r\n\r\nexport default getWAV;","import React, { useState } from 'react';\r\nimport './Generator.css';\r\nimport { getTone } from '../../waves/sine/tones.js';\r\nimport getWAV from '../../wav/WAVWriter.js';\r\nimport { SAMPLES, SIZE, VOLUME } from '../../constants.js';\r\n\r\nfunction Generator({ notes }) {\r\n  let [waveData, setWaveData] = useState(null);\r\n  const clickHandler = () => {\r\n    setWaveData(0);\r\n    setTimeout(() => {\r\n      const arr = new Array(SIZE).fill(0);\r\n      for(const note of notes) {\r\n        const offset = note.getOffset();\r\n        const wave = getTone(note.getTone(), note.getLength());\r\n        console.log(note.getTone());\r\n        for(let i = 0; i < wave.length; i++) {\r\n          const arrIndex = SAMPLES * 2 * offset + i;\r\n          arr[arrIndex] += wave[i];\r\n        }\r\n      }\r\n      const normalizedArr = normalize(arr);\r\n      console.log(normalizedArr);\r\n      setWaveData(getWAV(normalizedArr));\r\n    }, 0);\r\n  }\r\n\r\n  const normalize = (arr) => {\r\n    const max = arr.reduce((max, x) => Math.max(max, x), 0);\r\n    if(max > VOLUME) {\r\n      return arr.map(x => Math.floor(x * (VOLUME/max)));\r\n    }\r\n    return arr;\r\n  }\r\n\r\n  const getAudio = () => {\r\n    if(waveData) {\r\n      return <audio src={waveData} controls></audio>;\r\n    }\r\n    if(waveData === 0) {\r\n      return <div>Generating...</div>\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"generator\">\r\n      <button onClick={clickHandler}>Generate!</button>\r\n      {getAudio()}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Generator;\r\n","import React from 'react';\r\nimport Display from './Display.js';\r\nimport Generator from './Generator.js';\r\n\r\nfunction Roll() {\r\n  const notes = [];\r\n\r\n  return (\r\n    <div>\r\n      <Display notes={notes}></Display>\r\n      <Generator notes={notes}></Generator>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Roll;\r\n","import Roll from './components/roll/Roll.js';\nimport './App.css';\n\nfunction App() {\n  return (\n    <div className=\"app\">\n      <Roll></Roll>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}