(this["webpackJsonpsound-wave-composer"]=this["webpackJsonpsound-wave-composer"]||[]).push([[0],[,,,,,,,,,,,,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var a={};n.r(a),n.d(a,"sine",(function(){return y})),n.d(a,"square",(function(){return x})),n.d(a,"sawtooth",(function(){return m})),n.d(a,"triangle",(function(){return w}));var c=n(1),r=n.n(c),i=n(8),o=n.n(i),u=(n(15),n(2)),s=n(4),f=(n(16),n(3)),l=(n(17),n(0));for(var h=function(t){var e=t.notes,n=t.draw,a=t.deleteNotes,r=Object(c.useState)(0),i=Object(u.a)(r,2),o=i[0],s=i[1],h=Object(c.useState)(0),v=Object(u.a)(h,2),j=v[0],b=v[1];return Object(c.useEffect)((function(){s(e[0].tuningOffset),b(e[0].getLength())}),[e]),Object(l.jsxs)("div",{className:"note-settings",children:["Tuning offset ",Object(l.jsx)("input",{value:o,onChange:function(t){var a=t.target.value;s(a);var c,r=Object(f.a)(e);try{for(r.s();!(c=r.n()).done;){c.value.setTuningOffset(Number(a))}}catch(i){r.e(i)}finally{r.f()}n()}})," cents.",Object(l.jsx)("br",{}),"Length ",Object(l.jsx)("input",{value:j,onChange:function(t){var a=t.target.value;b(a);var c,r=Object(f.a)(e);try{for(r.s();!(c=r.n()).done;){c.value.setLength(Number(a))}}catch(i){r.e(i)}finally{r.f()}n()}}),"beats.",Object(l.jsx)("br",{}),Object(l.jsx)("button",{onClick:a,children:"Delete"})]})},v=440,j=[v,v*Math.pow(2,1/12),v*Math.pow(2,2/12),v*Math.pow(2,.25),v*Math.pow(2,4/12),v*Math.pow(2,5/12),v*Math.pow(2,.5),v*Math.pow(2,7/12),v*Math.pow(2,8/12),v*Math.pow(2,.75),v*Math.pow(2,10/12),v*Math.pow(2,11/12)].reverse(),b=["A4","A\u266f4","B4","C5","C\u266f5","D5","D\u266f5","E5","F5","F\u266f5","G5","G\u266f5"].reverse(),O=44100,g=8191.75,d=80,p=20,y=function(t,e){return Math.sin(2*Math.PI*t*e)},x=function(t,e){return Math.sign(y(t,e))},m=function(t,e){return 2*(e*t-Math.floor(.5+e*t))},w=function(t,e){return 2*Math.abs(m(t,e))-1},M=["#0c0","#c00","#cc0","#00c"],k=Object.keys(a),N={},S=0;S<M.length;S++)N[k[S]]=M[S];var C=N,T=(n(19),b.length),B=T*p,L=400,R=B+16,D=function(t){return t.reduce((function(t,e){return Math.max(t,e.getBeatEnd())}),0)},E=function(t){return Math.min(L/((D(t)+2)*d),1)*L},A=function(t){return L-E(t)};var W=function(t){var e=t.notes,n=t.setNotes,a=t.beatDivision,r=t.makeNewNote,i=Object(c.useRef)(null),o=Object(c.useState)([]),v=Object(u.a)(o,2),j=v[0],O=v[1],g=Object(c.useState)(!1),y=Object(u.a)(g,2),x=y[0],m=y[1],w=Object(c.useState)(!1),M=Object(u.a)(w,2),k=M[0],N=M[1],S=Object(c.useState)(0),W=Object(u.a)(S,2),F=W[0],U=W[1],X=function(){var t=A(e);if(0===t)return 0;var n=F/t;return(D(e)-3)*n},Y=function(){var t=i.current.getContext("2d");t.clearRect(0,0,400,R),G(t),V(t),J(t),K(t)},G=function(t){t.lineWidth=1,t.strokeStyle="#666",I(t),P(t)},I=function(t){for(var e=1;e<=T;e++){var n=p*e+.5;t.beginPath(),t.moveTo(0,n),t.lineTo(L,n),t.stroke()}},P=function(t){for(var e=X(),n=6*a,c=1;c<=n;c++){var r=e%1*a,i=d/a,o=Math.floor(i*(c-r))+.5;t.lineWidth=c%a===0?3:1,t.beginPath(),t.moveTo(o,0),t.lineTo(o,B),t.stroke()}},V=function(t){var n,a=X(),c=a+5,r=Object(f.a)(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.inView(a,c)){var o=(i.getOffset()-a)*d,u=i.getY();t.fillStyle=C[i.func],t.fillRect(o+2,u+2,i.width-3,i.height-3),t.strokeStyle=j.includes(i)?"#900":"#666",t.lineWidth=2,t.strokeRect(o+2.5,u+2.5,i.width-4,i.height-4)}}}catch(s){r.e(s)}finally{r.f()}},J=function(t){t.font="16px sans-serif",t.fillStyle="#000";for(var e=0;e<T;e++)t.fillText(b[e],0,p*(e+1)-4)},K=function(t){var n=E(e);t.fillStyle="#999",t.fillRect(F,B,n,16)},q=function(t){O(x?[].concat(Object(s.a)(j),[t]):[t])},z=function(t){var e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}};return Object(c.useEffect)((function(){return Y()})),Object(l.jsxs)("div",{className:"canvas",children:[Object(l.jsxs)("div",{className:"canvas-wrapper",children:[Object(l.jsx)("canvas",{ref:i,width:400,height:R,tabIndex:"0",onClick:function(t){var n=z(t);if(!(n.y>=B)){var c,i=X()*d,o=Object(f.a)(e);try{for(o.s();!(c=o.n()).done;){var u=c.value;if(u.inRect(n.x+i,n.y))return q(u),void Y()}}catch(g){o.e(g)}finally{o.f()}var l=d/a,h=Math.floor((n.x+i)/l)*l,v=Math.floor(n.y/p)*p,j=F/E(e),b=r(h,v);O([]),U(j*E([].concat(Object(s.a)(e),[b]))),Y()}},onKeyDown:function(t){"Control"===t.key&&m(!0)},onKeyUp:function(t){"Control"===t.key&&m(!1)},onMouseDown:function(t){z(t).y>=B&&N(!0)},onMouseMove:function(t){if(k){var n=F+t.movementX;n=Math.max(n,0),n=Math.min(n,A(e)),U(n)}},onMouseUp:function(t){N(!1)}}),Object(l.jsx)("button",{onClick:function(){n([]),O([]),U(0),Y()},children:"Clear"})]}),j.length>0&&Object(l.jsx)(h,{notes:j,draw:Y,deleteNotes:function(){var t=e.filter((function(t){return!j.includes(t)}));n(Object(s.a)(t)),O([]),U(Math.min(F,A(t)))}})]})};n(20);var F=function(t){var e=t.setNewNoteLength,n=t.setBeatDivision,r=t.setTempo,i=t.setWaveFunction,o=Object(c.useState)(1),s=Object(u.a)(o,2),f=s[0],h=s[1],v=Object(c.useState)(4),j=Object(u.a)(v,2),b=j[0],O=j[1],g=Object(c.useState)(60),d=Object(u.a)(g,2),p=d[0],y=d[1],x=Object(c.useState)("sine"),m=Object(u.a)(x,2),w=m[0],M=m[1];return Object(l.jsxs)("div",{className:"display-settings",children:["New note length ",Object(l.jsx)("input",{value:f,onChange:function(t){var n=t.target.value;h(n),e(n)}}),"beats.",Object(l.jsx)("br",{}),"Beat division ",Object(l.jsx)("input",{value:b,onChange:function(t){var e=t.target.value;O(e),n(e)}}),".",Object(l.jsx)("br",{}),"Tempo ",Object(l.jsx)("input",{value:p,onChange:function(t){var e=t.target.value;y(e),r(e)}}),"bpm.",Object(l.jsx)("br",{}),"Wave ",Object(l.jsx)("select",{value:w,onChange:function(t){var e=t.target.value;M(e),i(e)},children:Object.keys(a).map((function(t){return Object(l.jsx)("option",{value:t,children:t},t)}))})]})},U=n(9),X=n(10),Y=function(){function t(e,n,a,c){Object(U.a)(this,t),this.x=e,this.y=n,this.width=d*a,this.height=p,this.tuningOffset=0,this.length=a,this.func=c}return Object(X.a)(t,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y-this.tuningOffset/100*p}},{key:"getOffset",value:function(){return this.x/d}},{key:"getTone",value:function(){return j[this.y/p]*Math.pow(2,this.tuningOffset/1200)}},{key:"getLength",value:function(){return this.length}},{key:"getBeatEnd",value:function(){return this.getOffset()+this.getLength()}},{key:"setLength",value:function(t){this.length=t,this.width=d*t}},{key:"setTuningOffset",value:function(t){this.tuningOffset=t}},{key:"inRect",value:function(t,e){return t>=this.getX()&&t<=this.getX()+this.width&&e>=this.getY()&&e<=this.getY()+this.height}},{key:"inView",value:function(t,e){return this.getOffset()<e||this.getBeatEnd()>t}}]),t}();var G=function(t){var e=t.notes,n=t.setNotes,a=t.setTempo,r=Object(c.useState)(1),i=Object(u.a)(r,2),o=i[0],f=i[1],h=Object(c.useState)(4),v=Object(u.a)(h,2),j=v[0],b=v[1],O=Object(c.useState)("sine"),g=Object(u.a)(O,2),d=g[0],p=g[1];return Object(l.jsxs)("div",{className:"display",children:[Object(l.jsx)(F,{setNewNoteLength:function(t){f(t)},setBeatDivision:function(t){b(t)},setTempo:function(t){a(t)},setWaveFunction:function(t){p(t)}}),Object(l.jsx)(W,{notes:e,setNotes:n,beatDivision:j,makeNewNote:function(t,a){var c=new Y(t,a,Number(o),d),r=[].concat(Object(s.a)(e),[c]);return n(Object(s.a)(r)),c}})]})};n(21);var I=function(t,e,n){for(var a=[],c=0;c<O*e;c++){var r=Math.floor(n(t,c/O)*g);a.push(r,r)}return a};function P(t,e){for(var n=new Array(e).fill(0),a=0;a<e;a++){var c=t>>8*a&255;n[a]=c}return n.reverse(),n}function V(t){return t.split("").map((function(t){return t.charCodeAt(0)}))}function J(t,e){var n,a=Object(f.a)(e);try{for(a.s();!(n=a.n()).done;){var c=n.value;t.push(c)}}catch(r){a.e(r)}finally{a.f()}}function K(t,e){for(var n=e.length-1;n>=0;n--)t.push(e[n])}var q=function(t,e){var n=[];!function(t,e){J(t,V("RIFF")),K(t,P(36+e,4)),J(t,V("WAVE")),J(t,V("fmt ")),K(t,P(16,4)),K(t,P(1,2)),K(t,P(2,2)),K(t,P(O,4)),K(t,P(176400,4)),K(t,P(4,2)),K(t,P(16,2)),J(t,V("data")),K(t,P(e,4))}(n,e),function(t,e){var n,a=Object(f.a)(e);try{for(a.s();!(n=a.n()).done;)K(t,P(n.value,2))}catch(c){a.e(c)}finally{a.f()}}(n,t);var a=new Uint8Array(n),c=new Blob([a],{type:"application/octet-stream"});return window.URL.createObjectURL(c)};var z=function(t){var e=t.notes,n=t.tempo,r=Object(c.useState)(null),i=Object(u.a)(r,2),o=i[0],s=i[1],h=function(t){var e=t.reduce((function(t,e){return Math.max(t,e)}),0);return e>g?t.map((function(t){return Math.floor(t*(g/e))})):t};return Object(l.jsxs)("div",{className:"generator",children:[Object(l.jsx)("button",{onClick:function(){var t=e.reduce((function(t,e){return Math.max(t,e.getBeatEnd())}),0)/(n/60),c=Math.ceil(176400*t);s(0),setTimeout((function(){var t,r=new Array(c).fill(0),i=Object(f.a)(e);try{for(i.s();!(t=i.n()).done;)for(var o=t.value,u=o.getOffset()/(n/60),l=I(o.getTone(),o.getLength()/(n/60),a[o.func]),v=0;v<l.length;v++){r[Math.floor(88200*u)+v]+=l[v]}}catch(b){i.e(b)}finally{i.f()}var j=h(r);s(q(j,c))}),0)},children:"Generate!"}),o?Object(l.jsx)("audio",{src:o,controls:!0}):0===o?Object(l.jsx)("div",{children:"Generating..."}):void 0]})};var H=function(){var t=Object(c.useState)([]),e=Object(u.a)(t,2),n=e[0],a=e[1],r=Object(c.useState)(60),i=Object(u.a)(r,2),o=i[0],s=i[1];return Object(l.jsxs)("div",{children:[Object(l.jsx)(G,{notes:n,setNotes:a,tempo:o,setTempo:s}),Object(l.jsx)(z,{notes:n,tempo:o})]})};n(22);var Q=function(){return Object(l.jsx)("div",{className:"app",children:Object(l.jsx)(H,{})})};o.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(Q,{})}),document.getElementById("root"))}],[[23,1,2]]]);
//# sourceMappingURL=main.f9ac48af.chunk.js.map