(this["webpackJsonpsound-wave-composer"]=this["webpackJsonpsound-wave-composer"]||[]).push([[0],[,,,,,,,,,,,,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var c={};n.r(c),n.d(c,"sine",(function(){return d})),n.d(c,"square",(function(){return p})),n.d(c,"sawtooth",(function(){return x})),n.d(c,"triangle",(function(){return y}));var a=n(1),i=n.n(a),s=n(10),o=n.n(s),r=(n(15),n(3)),u=n(2),l=(n(16),n(7)),h=(n(17),n(0));for(var f=function(t){var e=t.notes,n=t.draw,c=t.deleteNotes,i=Object(a.useState)(0),s=Object(u.a)(i,2),o=s[0],r=s[1],f=Object(a.useState)(0),j=Object(u.a)(f,2),v=j[0],b=j[1];return Object(a.useEffect)((function(){r(e[0].tuningOffset),b(e[0].getLength())}),[e]),Object(h.jsxs)("div",{className:"note-settings",children:["Tuning offset ",Object(h.jsx)("input",{value:o,onChange:function(t){var c=t.target.value;r(c);var a,i=Object(l.a)(e);try{for(i.s();!(a=i.n()).done;){a.value.setTuningOffset(Number(c))}}catch(s){i.e(s)}finally{i.f()}n()}})," cents.",Object(h.jsx)("br",{}),"Length ",Object(h.jsx)("input",{value:v,onChange:function(t){var c=t.target.value;b(c);var a,i=Object(l.a)(e);try{for(i.s();!(a=i.n()).done;){a.value.setLength(Number(c))}}catch(s){i.e(s)}finally{i.f()}n()}}),"beats.",Object(h.jsx)("br",{}),Object(h.jsx)("button",{onClick:c,children:"Delete"})]})},j=440,v=[j,j*Math.pow(2,1/12),j*Math.pow(2,2/12),j*Math.pow(2,.25),j*Math.pow(2,4/12),j*Math.pow(2,5/12),j*Math.pow(2,.5),j*Math.pow(2,7/12),j*Math.pow(2,8/12),j*Math.pow(2,.75),j*Math.pow(2,10/12),j*Math.pow(2,11/12)].reverse(),b=["A4","A\u266f4","B4","C5","C\u266f5","D5","D\u266f5","E5","F5","F\u266f5","G5","G\u266f5"].reverse(),O=80,g=20,d=function(t,e){return Math.sin(2*Math.PI*t*e)},p=function(t,e){return Math.sign(d(t,e))},x=function(t,e){return 2*(e*t-Math.floor(.5+e*t))},y=function(t,e){return 2*Math.abs(x(t,e))-1},m=["#0c0","#c00","#cc0","#00c"],w=Object.keys(c),k={},T=0;T<m.length;T++)k[w[T]]=m[T];var N=k,M=(n(19),b.length),S=M*g,C=400,I=S+16,P=function(t){return t.reduce((function(t,e){return Math.max(t,e.getBeatEnd())}),0)},D=function(t){return Math.min(C/((P(t)+2)*O),1)*C},E=function(t){return C-D(t)};var W=function(t){var e=t.notes,n=t.setNotes,c=t.beatDivision,i=t.makeNewNote,s=Object(a.useRef)(null),o=Object(a.useState)([]),j=Object(u.a)(o,2),v=j[0],d=j[1],p=Object(a.useState)(!1),x=Object(u.a)(p,2),y=x[0],m=x[1],w=Object(a.useState)(!1),k=Object(u.a)(w,2),T=k[0],W=k[1],B=Object(a.useState)(0),L=Object(u.a)(B,2),F=L[0],R=L[1],A=function(){var t=E(e);if(0===t)return 0;var n=F/t;return(P(e)-3)*n},X=function(){var t=s.current.getContext("2d");t.clearRect(0,0,400,I),q(t),G(t),J(t),K(t)},q=function(t){t.lineWidth=1,t.strokeStyle="#666",Y(t),V(t)},Y=function(t){for(var e=1;e<=M;e++){var n=g*e+.5;t.beginPath(),t.moveTo(0,n),t.lineTo(C,n),t.stroke()}},V=function(t){for(var e=A(),n=6*c,a=1;a<=n;a++){var i=e%1*c,s=O/c,o=Math.floor(s*(a-i))+.5;t.lineWidth=a%c===0?3:1,t.beginPath(),t.moveTo(o,0),t.lineTo(o,S),t.stroke()}},G=function(t){var n,c=A(),a=c+5,i=Object(l.a)(e);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s.inView(c,a)){var o=(s.getOffset()-c)*O,r=s.getY();t.fillStyle=N[s.func],t.fillRect(o+2,r+2,s.width-3,s.height-3),t.strokeStyle=v.includes(s)?"#900":"#666",t.lineWidth=2,t.strokeRect(o+2.5,r+2.5,s.width-4,s.height-4)}}}catch(u){i.e(u)}finally{i.f()}},J=function(t){t.font="16px sans-serif",t.fillStyle="#000";for(var e=0;e<M;e++)t.fillText(b[e],0,g*(e+1)-4)},K=function(t){var n=D(e);t.fillStyle="#999",t.fillRect(F,S,n,16)},U=function(t){d(y?[].concat(Object(r.a)(v),[t]):[t])},_=function(t){var e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}};return Object(a.useEffect)((function(){return X()})),Object(h.jsxs)("div",{className:"canvas",children:[Object(h.jsxs)("div",{className:"canvas-wrapper",children:[Object(h.jsx)("canvas",{ref:s,width:400,height:I,tabIndex:"0",onClick:function(t){var n=_(t);if(!(n.y>=S)){var a,s=A()*O,o=Object(l.a)(e);try{for(o.s();!(a=o.n()).done;){var u=a.value;if(u.inRect(n.x+s,n.y))return U(u),void X()}}catch(p){o.e(p)}finally{o.f()}var h=O/c,f=Math.floor((n.x+s)/h)*h,j=Math.floor(n.y/g)*g,v=F/D(e),b=i(f,j);d([]),R(v*D([].concat(Object(r.a)(e),[b]))),X()}},onKeyDown:function(t){"Control"===t.key&&m(!0)},onKeyUp:function(t){"Control"===t.key&&m(!1)},onMouseDown:function(t){_(t).y>=S&&W(!0)},onMouseMove:function(t){if(T){var n=F+t.movementX;n=Math.max(n,0),n=Math.min(n,E(e)),R(n)}},onMouseUp:function(t){W(!1)}}),Object(h.jsx)("button",{onClick:function(){n([]),d([]),R(0),X()},children:"Clear"})]}),v.length>0&&Object(h.jsx)(f,{notes:v,draw:X,deleteNotes:function(){var t=e.filter((function(t){return!v.includes(t)}));n(Object(r.a)(t)),d([]),R(Math.min(F,E(t)))}})]})};n(20);var B=function(t){var e=t.setNewNoteLength,n=t.setBeatDivision,i=t.setTempo,s=t.setWaveFunction,o=t.patches,l=Object(a.useState)(1),f=Object(u.a)(l,2),j=f[0],v=f[1],b=Object(a.useState)(4),O=Object(u.a)(b,2),g=O[0],d=O[1],p=Object(a.useState)(60),x=Object(u.a)(p,2),y=x[0],m=x[1],w=Object(a.useState)("sine"),k=Object(u.a)(w,2),T=k[0],N=k[1];return Object(h.jsxs)("div",{className:"display-settings",children:["New note length ",Object(h.jsx)("input",{value:j,onChange:function(t){var n=t.target.value;v(n),e(n)}}),"beats.",Object(h.jsx)("br",{}),"Beat division ",Object(h.jsx)("input",{value:g,onChange:function(t){var e=t.target.value;d(e),n(e)}}),".",Object(h.jsx)("br",{}),"Tempo ",Object(h.jsx)("input",{value:y,onChange:function(t){var e=t.target.value;m(e),i(e)}}),"bpm.",Object(h.jsx)("br",{}),"Wave ",Object(h.jsx)("select",{value:T,onChange:function(t){var e=t.target.value;N(e),s(e)},children:[].concat(Object(r.a)(Object.keys(c)),Object(r.a)(o.map((function(t){return t.getName()})))).map((function(t){return Object(h.jsx)("option",{value:t,children:t},t)}))})]})},L=n(4),F=n(5),R=function(){function t(e,n,c,a){Object(L.a)(this,t),this.x=e,this.y=n,this.width=O*c,this.height=g,this.tuningOffset=0,this.length=c,this.func=a}return Object(F.a)(t,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y-this.tuningOffset/100*g}},{key:"getOffset",value:function(){return this.x/O}},{key:"getTone",value:function(){return v[this.y/g]*Math.pow(2,this.tuningOffset/1200)}},{key:"getLength",value:function(){return this.length}},{key:"getBeatEnd",value:function(){return this.getOffset()+this.getLength()}},{key:"getType",value:function(){return this.func}},{key:"setLength",value:function(t){this.length=t,this.width=O*t}},{key:"setTuningOffset",value:function(t){this.tuningOffset=t}},{key:"inRect",value:function(t,e){return t>=this.getX()&&t<=this.getX()+this.width&&e>=this.getY()&&e<=this.getY()+this.height}},{key:"inView",value:function(t,e){return this.getOffset()<e||this.getBeatEnd()>t}}]),t}();var A=function(t){var e=t.notes,n=t.setNotes,c=t.setTempo,i=t.patches,s=Object(a.useState)(1),o=Object(u.a)(s,2),l=o[0],f=o[1],j=Object(a.useState)(4),v=Object(u.a)(j,2),b=v[0],O=v[1],g=Object(a.useState)("sine"),d=Object(u.a)(g,2),p=d[0],x=d[1];return Object(h.jsxs)("div",{className:"display",children:[Object(h.jsx)(B,{setNewNoteLength:function(t){f(t)},setBeatDivision:function(t){O(t)},setTempo:function(t){c(t)},setWaveFunction:function(t){x(t)},patches:i}),Object(h.jsx)(W,{notes:e,setNotes:n,beatDivision:b,makeNewNote:function(t,c){var a=new R(t,c,Number(l),p),i=[].concat(Object(r.a)(e),[a]);return n(Object(r.a)(i)),a}})]})},X=function(){function t(e,n,c,a,i){Object(L.a)(this,t),this.osc=a.createOscillator(),this.osc.type=e,this.osc.frequency.setValueAtTime(n,a.currentTime),this.osc.connect(i),this.osc.start(),this.osc.stop(a.currentTime+c/1e3)}return Object(F.a)(t,[{key:"stop",value:function(){this.osc.stop()}}]),t}(),q=function(){function t(e,n,c,a,i){var s=this;Object(L.a)(this,t),this.patch=e,this.oscillators=[],this.patch.getOscillators().forEach((function(t){return s.oscillators.push(new X(t.getWaveType(),s.getTone(t,n),c,a,i))}))}return Object(F.a)(t,[{key:"getTone",value:function(t,e){var n=100*t.getTune()+t.getFineTune();return e*Math.pow(2,n/1200)}},{key:"stop",value:function(){this.oscillators.forEach((function(t){return t.stop()})),this.oscillators=[]}}]),t}(),Y=function(){function t(){Object(L.a)(this,t),this.waveType="sine",this.tune=0,this.fineTune=0}return Object(F.a)(t,[{key:"setWaveType",value:function(t){this.waveType=t}},{key:"setTune",value:function(t){this.tune=t}},{key:"setFineTune",value:function(t){this.fineTune=t}},{key:"getWaveType",value:function(){return this.waveType}},{key:"getTune",value:function(){return this.tune}},{key:"getFineTune",value:function(){return this.fineTune}}]),t}(),V=function(){function t(){Object(L.a)(this,t),this.name="Patch",this.id=t.currentId,this.oscillators=[],t.currentId++}return Object(F.a)(t,[{key:"newOscillator",value:function(){var t=[].concat(Object(r.a)(this.oscillators),[new Y]);this.oscillators=t}},{key:"setName",value:function(t){this.name=t}},{key:"setOscillators",value:function(t){this.oscillators=t}},{key:"getName",value:function(){return this.name}},{key:"getId",value:function(){return this.name+"_"+this.id}},{key:"getOscillators",value:function(){return this.oscillators}}]),t}();V.currentId=0;var G=V,J=function(t){var e=new Y;e.setWaveType(t);var n=new G;return n.setOscillators([e]),n},K=function(){function t(){Object(L.a)(this,t),this.ctx=new(window.AudioContext||window.webkitAudioContext),this.volume=this.ctx.createGain(),this.volume.connect(this.ctx.destination),this.volume.gain.setValueAtTime(.25,this.ctx.currentTime),this.patches=[],this.interval=null}return Object(F.a)(t,[{key:"start",value:function(t,e,n){var c=this;this.stop();var a=6e4/(e*O),i=Object(r.a)(t).sort((function(t,e){return t.getOffset()-e.getOffset()})),s=0,o=i.reduce((function(t,e){return Math.max(t,e.getBeatEnd())}),0)*O,u=new Date;this.interval=setInterval((function(){for(var t=(new Date-u)/a,e=function(){var t=i[s],e=t.getLength()*O*a;if(["sine","square","sawtooth","triangle"].includes(t.getType())){var o=J(t.getType());c.patches.push(new q(o,t.getTone(),e,c.ctx,c.volume))}else{var r=n.find((function(e){return e.getName()===t.getType()}));c.patches.push(new q(r,t.getTone(),e,c.ctx,c.volume))}s++};s<i.length&&i[s].getX()<=t;)e();t>=o&&c.stop()}),a)}},{key:"stop",value:function(){this.patches.forEach((function(t){return t.stop()})),this.patches=[],clearInterval(this.interval)}}]),t}();var U=function(t){var e=t.patches,n=Object(a.useState)([]),c=Object(u.a)(n,2),i=c[0],s=c[1],o=Object(a.useState)(60),r=Object(u.a)(o,2),l=r[0],f=r[1],j=Object(a.useState)(new K),v=Object(u.a)(j,1)[0];return Object(h.jsxs)("div",{children:[Object(h.jsx)(A,{notes:i,setNotes:s,tempo:l,setTempo:f,patches:e}),Object(h.jsx)("button",{onClick:function(){v.start(i,l,e)},children:"Play"}),Object(h.jsx)("button",{onClick:function(){v.stop()},children:"Stop"})]})};n(21);var _=function(t){var e=t.oscillator,n=t.setOscillator,c=t.index,i=Object(a.useState)(e.waveType),s=Object(u.a)(i,2),o=s[0],r=s[1],l=Object(a.useState)(e.tune),f=Object(u.a)(l,2),j=f[0],v=f[1],b=Object(a.useState)(e.fineTune),O=Object(u.a)(b,2),g=O[0],d=O[1];return Object(h.jsxs)("div",{className:"synth-oscillator",children:[Object(h.jsxs)("select",{value:o,onChange:function(t){var a=t.target.value;r(a),e.setWaveType(a),n(e,c)},children:[Object(h.jsx)("option",{value:"sine",children:"Sine"}),Object(h.jsx)("option",{value:"square",children:"Square"}),Object(h.jsx)("option",{value:"sawtooth",children:"Sawtooth"}),Object(h.jsx)("option",{value:"triangle",children:"Triangle"})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("input",{type:"range",min:"-24",max:"24",value:j,onChange:function(t){var a=Number(t.target.value);v(a),e.setTune(a),n(e,c)}})," ",j,"st"]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("input",{type:"range",min:"-100",max:"100",value:g,onChange:function(t){var a=Number(t.target.value);d(a),e.setFineTune(a),n(e,c)}})," ",g,"ct"]})]})};n(22);var z=function(t){var e=t.oscillators,n=t.newOscillator,c=t.setOscillator,a=t.patchId;return Object(h.jsxs)("div",{className:"synth-oscillator-container",children:[e.map((function(t,e){return Object(h.jsx)(_,{oscillator:t,setOscillator:c,index:e},a+e)})),Object(h.jsx)("button",{onClick:n,children:"+"})]})};n(23);var H=function(t){var e=t.patch,n=t.setPatch,c=t.patchId;return Object(h.jsxs)("div",{className:"synth-patch",children:["Patch name: ",Object(h.jsx)("input",{value:e.getName(),onChange:function(t){var c=t.target.value;e.setName(c),n(e)}}),Object(h.jsx)(z,{oscillators:e.oscillators,newOscillator:function(){e.newOscillator(),n(e)},setOscillator:function(t,c){var a=Object(r.a)(e.oscillators);a[c]=t,e.setOscillators(a),n(e)},patchId:c})]})};n(24);var Q=function(t){var e=t.patches,n=t.setPatch,c=t.newPatch,i=Object(a.useState)(-1),s=Object(u.a)(i,2),o=s[0],r=s[1];return Object(h.jsxs)("div",{className:"synth-patch-container",children:[Object(h.jsxs)("div",{className:"synth-patch-container-selector",children:[Object(h.jsx)("select",{onChange:function(t){var e=Number(t.target.value);r(e)},value:o,children:e.map((function(t,e){return Object(h.jsx)("option",{value:e,children:t.name},e)}))}),Object(h.jsx)("button",{onClick:function(){r(e.length),c()},children:"+"})]}),Object(h.jsx)("div",{className:"synth-patch-container-editor",children:function(){if(o>=0){var t=e[o];return Object(h.jsx)(H,{patch:t,setPatch:n,patchId:t.getId()})}}()})]})};n(25);var Z=function(t){var e=t.patches,n=t.setPatch,c=t.newPatch;return Object(h.jsx)("div",{className:"synth",children:Object(h.jsx)(Q,{patches:e,setPatch:n,newPatch:c})})};n(26);var $=function(){var t=Object(a.useState)([]),e=Object(u.a)(t,2),n=e[0],c=e[1];return Object(h.jsxs)("div",{className:"app",children:[Object(h.jsx)(Z,{patches:n,setPatch:function(t){var e=Object(r.a)(n),a=e.findIndex((function(e){return e.getId()===t.getId()}));e[a]=t,c(e)},newPatch:function(){c([].concat(Object(r.a)(n),[new G]))}}),Object(h.jsx)(U,{patches:n})]})};o.a.render(Object(h.jsx)(i.a.StrictMode,{children:Object(h.jsx)($,{})}),document.getElementById("root"))}],[[27,1,2]]]);
//# sourceMappingURL=main.ec0c9ed1.chunk.js.map